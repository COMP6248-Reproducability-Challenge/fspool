

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>torch_geometric.nn &mdash; pytorch_geometric master documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="pytorch_geometric master documentation" href="../index.html"/>
        <link rel="next" title="torch_geometric.data" href="data.html"/>
        <link rel="prev" title="Create your own dataset" href="../notes/create_dataset.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.svg" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                master (1.0.0)
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notes/installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../notes/installation.html#c-cuda-extensions-on-macos">C++/CUDA extensions on macOS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../notes/introduction.html">Introduction by example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../notes/introduction.html#data-handling-of-graphs">Data handling of graphs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/introduction.html#common-benchmark-datasets">Common benchmark datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/introduction.html#mini-batches">Mini-batches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/introduction.html#data-transforms">Data transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/introduction.html#learning-methods-on-graphs">Learning methods on graphs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../notes/create_dataset.html">Create your own dataset</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../notes/create_dataset.html#creating-in-memory-datasets">Creating “in memory datasets”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/create_dataset.html#creating-larger-datasets">Creating “larger” datasets</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">torch_geometric.nn</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-torch_geometric.nn.conv">Sparse Convolutional Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-torch_geometric.nn.dense.sage_conv">Dense Convolutional Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-torch_geometric.nn.glob">Global Pooling Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-torch_geometric.nn.pool">Sparse Hierarchical Pooling Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-torch_geometric.nn.dense.diff_pool">Dense Hierarchical Pooling Layers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data.html">torch_geometric.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasets.html">torch_geometric.datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="transforms.html">torch_geometric.transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">torch_geometric.utils</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pytorch_geometric</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>torch_geometric.nn</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/modules/nn.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="torch-geometric-nn">
<h1>torch_geometric.nn<a class="headerlink" href="#torch-geometric-nn" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#module-torch_geometric.nn.conv" id="id1">Sparse Convolutional Layers</a></li>
<li><a class="reference internal" href="#module-torch_geometric.nn.dense.sage_conv" id="id2">Dense Convolutional Layers</a></li>
<li><a class="reference internal" href="#module-torch_geometric.nn.glob" id="id3">Global Pooling Layers</a></li>
<li><a class="reference internal" href="#module-torch_geometric.nn.pool" id="id4">Sparse Hierarchical Pooling Layers</a></li>
<li><a class="reference internal" href="#module-torch_geometric.nn.dense.diff_pool" id="id5">Dense Hierarchical Pooling Layers</a></li>
</ul>
</div>
<div class="section" id="module-torch_geometric.nn.conv">
<span id="sparse-convolutional-layers"></span><h2><a class="toc-backref" href="#id1">Sparse Convolutional Layers</a><a class="headerlink" href="#module-torch_geometric.nn.conv" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch_geometric.nn.conv.GCNConv">
<em class="property">class </em><code class="descname">GCNConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>improved=False</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gcn_conv.html#GCNConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GCNConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The graph convolutional operator from the <a class="reference external" href="https://arxiv.org/abs/1609.02907">“Semi-supervised
Classfication with Graph Convolutional Networks”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{X}^{\prime} = \mathbf{\hat{D}}^{-1/2} \mathbf{\hat{A}}
\mathbf{\hat{D}}^{-1/2} \mathbf{X} \mathbf{\Theta},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{\hat{A}} = \mathbf{A} + \mathbf{I}\)</span> denotes the
adjacency matrix with inserted self-loops and
<span class="math notranslate nohighlight">\(\hat{D}_{ii} = \sum_{j=0} \hat{A}_{ij}\)</span> its diagonal degree matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>improved</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the layer computes
<span class="math notranslate nohighlight">\(\mathbf{\hat{A}}\)</span> as <span class="math notranslate nohighlight">\(\mathbf{A} + 2\mathbf{I}\)</span>.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>)</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.GCNConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em>, <em>edge_attr=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gcn_conv.html#GCNConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GCNConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.GCNConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gcn_conv.html#GCNConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GCNConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.ChebConv">
<em class="property">class </em><code class="descname">ChebConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>K</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/cheb_conv.html#ChebConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.ChebConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The chebyshev spectral graph convolutional operator from the
<a class="reference external" href="https://arxiv.org/abs/1606.09375">“Convolutional Neural Networks on Graphs with Fast Localized Spectral
Filtering”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{X}^{\prime} = \sum_{k=0}^{K-1} \mathbf{\hat{X}}_k \cdot
\mathbf{\Theta}_k\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{\hat{X}}_k\)</span> is computed recursively by</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathbf{\hat{X}}_0 &amp;= \mathbf{X}\\\mathbf{\hat{X}}_1 &amp;= \mathbf{\hat{L}} \cdot \mathbf{X}\\\mathbf{\hat{X}}_k &amp;= 2 \cdot \mathbf{\hat{L}} \cdot
\mathbf{\hat{X}}_{k-1} - \mathbf{\hat{X}}_{k-2}\end{aligned}\end{align} \]</div>
<p>and <span class="math notranslate nohighlight">\(\mathbf{\hat{L}}\)</span> denotes the scaled and normalized Lalplacian.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>K</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Chebyshev filter size, <em>i.e.</em> number of hops.</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.ChebConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em>, <em>edge_attr=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/cheb_conv.html#ChebConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.ChebConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.ChebConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/cheb_conv.html#ChebConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.ChebConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.SAGEConv">
<em class="property">class </em><code class="descname">SAGEConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>normalize=True</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/sage_conv.html#SAGEConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.SAGEConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The GraphSAGE operator from the <a class="reference external" href="https://arxiv.org/abs/1706.02216">“Inductive Representation Learning on
Large Graphs”</a> paper</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathbf{\hat{x}}_i &amp;= \mathbf{\Theta} \cdot
\mathrm{mean}_{j \in \mathcal{N(i) \cup \{ i \}}}(\mathbf{x}_j)\\\mathbf{x}^{\prime}_i &amp;= \frac{\mathbf{\hat{x}}_i}
{\| \mathbf{\hat{x}}_i \|_2}.\end{aligned}\end{align} \]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>normalize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, output features
will not be <span class="math notranslate nohighlight">\(\ell^2\)</span>-normalized.</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.SAGEConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/sage_conv.html#SAGEConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.SAGEConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.SAGEConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/sage_conv.html#SAGEConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.SAGEConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.GraphConv">
<em class="property">class </em><code class="descname">GraphConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>aggr='add'</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/graph_conv.html#GraphConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GraphConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The graph neural network operator from the <a class="reference external" href="https://arxiv.org/abs/1810.02244">“Weisfeiler and Leman Go
Neural: Higher-order Graph Neural Networks”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{\prime}_i = \mathbf{\Theta} \mathbf{x}_i +
\sum_{j \in \mathcal{N}(i)} \mathbf{\Theta} \mathbf{x}_j.\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>aggr</strong> (<em>string</em>) – The aggregation operator to use (one of <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;add&quot;</span></code>,
<code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code>). (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;add&quot;</span></code>)</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.GraphConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/graph_conv.html#GraphConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GraphConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.GraphConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/graph_conv.html#GraphConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GraphConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.GATConv">
<em class="property">class </em><code class="descname">GATConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>heads=1</em>, <em>concat=True</em>, <em>negative_slope=0.2</em>, <em>dropout=0</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gat_conv.html#GATConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GATConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The graph attentional operator from the <a class="reference external" href="https://arxiv.org/abs/1710.10903">“Graph Attention Networks”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{\prime}_i = \alpha_{i,i}\mathbf{\Theta}\mathbf{x}_{j} +
\sum_{j \in \mathcal{N}(i)} \alpha_{i,j}\mathbf{\Theta}\mathbf{x}_{j},\]</div>
<p>where the attention coefficients <span class="math notranslate nohighlight">\(\alpha_{i,j}\)</span> are computed as</p>
<div class="math notranslate nohighlight">
\[\alpha_{i,j} =
\frac{
\exp\left(\mathrm{LeakyReLU}\left(\mathbf{a}^{\top}
[\mathbf{\Theta}\mathbf{x}_i \, \Vert \, \mathbf{\Theta}\mathbf{x}_j]
\right)\right)}
{\sum_{k \in \mathcal{N}(i) \cup \{ i \}}
\exp\left(\mathrm{LeakyReLU}\left(\mathbf{a}^{\top}
[\mathbf{\Theta}\mathbf{x}_i \, \Vert \, \mathbf{\Theta}\mathbf{x}_k]
\right)\right)}.\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>heads</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Number of multi-head-attentions. (default:
<code class="xref py py-obj docutils literal notranslate"><span class="pre">1</span></code>)</li>
<li><strong>concat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the multi-head</li>
<li><strong>are averaged instead of concatenated.</strong><strong> (</strong><strong>default</strong> (<em>attentions</em>) – <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
<li><strong>negative_slope</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – LeakyReLU angle of the negative
slope. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">0.2</span></code>)</li>
<li><strong>dropout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – Dropout propbability of the normalized
attention coefficients which exposes each node to a stochastically
sampled neighborhood during training. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">0</span></code>)</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.GATConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gat_conv.html#GATConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GATConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.GATConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gat_conv.html#GATConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GATConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.AGNNConv">
<em class="property">class </em><code class="descname">AGNNConv</code><span class="sig-paren">(</span><em>requires_grad=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/agnn_conv.html#AGNNConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.AGNNConv" title="Permalink to this definition">¶</a></dt>
<dd><p>Graph attentional propagation layer from the
<a class="reference external" href="https://arxiv.org/abs/1803.03735">“Attention-based Graph Neural Network for Semi-Supervised Learning”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{X}^{\prime} = \mathbf{P} \mathbf{X},\]</div>
<p>where the propagation matrix <span class="math notranslate nohighlight">\(\mathbf{P}\)</span> is computed as</p>
<div class="math notranslate nohighlight">
\[P_{i,j} = \frac{\exp( \beta \cdot \cos(\mathbf{x}_i, \mathbf{x}_j))}
{\sum_{k \in \mathcal{N}(i)\cup \{ i \}} \exp( \beta \cdot
\cos(\mathbf{x}_i, \mathbf{x}_k))}\]</div>
<p>with trainable parameter <span class="math notranslate nohighlight">\(\beta\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>requires_grad</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, <span class="math notranslate nohighlight">\(\beta\)</span>
will not be trainable. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.AGNNConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/agnn_conv.html#AGNNConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.AGNNConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.AGNNConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/agnn_conv.html#AGNNConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.AGNNConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.GINConv">
<em class="property">class </em><code class="descname">GINConv</code><span class="sig-paren">(</span><em>nn</em>, <em>eps=0</em>, <em>train_eps=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gin_conv.html#GINConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GINConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The graph isomorphism operator from the <a class="reference external" href="https://arxiv.org/abs/1810.00826">“How Powerful are
Graph Neural Networks?”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{\prime}_i = h_{\mathbf{\Theta}} \left( (1 + \epsilon) \cdot
\mathbf{x}_i + \sum_{j \in \mathcal{N}(i)} \mathbf{x}_j \right),\]</div>
<p>here <span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span> denotes a neural network, <em>.i.e.</em> a MLP.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nn</strong> (<em>nn.Sequential</em>) – Neural network <span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span>.</li>
<li><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – (Initial) <span class="math notranslate nohighlight">\(\epsilon\)</span> value.
(default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">0</span></code>)</li>
<li><strong>train_eps</strong> (<em>bool optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, <span class="math notranslate nohighlight">\(\epsilon\)</span> will
be a trainable parameter. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.GINConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gin_conv.html#GINConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GINConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.GINConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gin_conv.html#GINConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GINConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.PointConv">
<em class="property">class </em><code class="descname">PointConv</code><span class="sig-paren">(</span><em>local_nn=None</em>, <em>global_nn=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/point_conv.html#PointConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.PointConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The PointNet set layer from the <a class="reference external" href="https://arxiv.org/abs/1612.00593">“PointNet: Deep Learning on Point Sets
for 3D Classification and Segmentation”</a> and <a class="reference external" href="https://arxiv.org/abs/1706.02413">“PointNet++: Deep Hierarchical
Feature Learning on Point Sets in a Metric Space”</a> papers</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{\prime}_i = \gamma_{\mathbf{\Theta}} \left( \max_{j \in
\mathcal{N}(i) \cup \{ i \}} h_{\mathbf{\Theta}} ( \mathbf{x}_j \,
\Vert \, \mathbf{p}_j - \mathbf{p}_i) \right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\gamma_{\mathbf{\Theta}}\)</span> and
<span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span> denote neural
networks, <em>.i.e.</em> MLPs, and <span class="math notranslate nohighlight">\(\mathbf{P} \in \mathbb{R}^{N \times D}\)</span>
defines the position of each point.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>local_nn</strong> (<em>nn.Sequential</em><em>, </em><em>optional</em>) – Neural network
<span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span>. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>global_nn</strong> (<em>nn.Sequential</em><em>, </em><em>optional</em>) – Neural network
<span class="math notranslate nohighlight">\(\gamma_{\mathbf{\Theta}}\)</span>. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.PointConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>pos</em>, <em>edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/point_conv.html#PointConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.PointConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.PointConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/point_conv.html#PointConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.PointConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.GMMConv">
<em class="property">class </em><code class="descname">GMMConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>dim</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gmm_conv.html#GMMConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GMMConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The gaussian mixture model convolutional operator from the <a class="reference external" href="https://arxiv.org/abs/1611.08402">“Geometric
Deep Learning on Graphs and Manifolds using Mixture Model CNNs”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{\prime}_i = \mathbf{\Theta} \cdot
\sum_{j \in \mathcal{N}(i) \cup \{ i \}} w(\mathbf{e}_{i,j}) \odot
\mathbf{x}_j,\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[w_m(\mathbf{e}) = \exp \left( -\frac{1}{2} {\left( \mathbf{e} -
\mathbf{\mu}_m \right)}^{\top} \Sigma_m^{-1} \left( \mathbf{e} -
\mathbf{\mu}_m \right) \right)\]</div>
<p>with trainable mean vector <span class="math notranslate nohighlight">\(\mathbf{\mu}_m\)</span> and diagonal covariance
matrix <span class="math notranslate nohighlight">\(\mathbf{\Sigma}_m\)</span> for each input channel <span class="math notranslate nohighlight">\(m\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Pseudo-coordinate dimensionality.</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.GMMConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em>, <em>pseudo</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gmm_conv.html#GMMConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GMMConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.GMMConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/gmm_conv.html#GMMConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.GMMConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.SplineConv">
<em class="property">class </em><code class="descname">SplineConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>dim</em>, <em>kernel_size</em>, <em>is_open_spline=True</em>, <em>degree=1</em>, <em>norm=True</em>, <em>root_weight=True</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/spline_conv.html#SplineConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.SplineConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The spline-based convolutional operator from the <a class="reference external" href="https://arxiv.org/abs/1711.08920">“SplineCNN: Fast
Geometric Deep Learning with Continuous B-Spline Kernels”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{\prime}_i = \frac{1}{|\mathcal{N}(i)|} \sum_{j \in
\mathcal{N}(i)} \mathbf{x}_j \cdot
h_{\mathbf{\Theta}}(\mathbf{e}_{i,j}),\]</div>
<p>where <span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span> denotes a kernel function defined
over the weighted B-Spline tensor product basis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Pseudo-coordinate dimensionality.</li>
<li><strong>kernel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>]</em>) – Size of the convolving kernel.</li>
<li><strong>is_open_spline</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em> or </em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>]</em><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the
operator will use a closed B-spline basis in this dimension.
(default <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
<li><strong>degree</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – B-spline basis degrees. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">1</span></code>)</li>
<li><strong>norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, output node features
will not be degree-normalized. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
<li><strong>root_weight</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will
not add transformed root node features to the output.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.SplineConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em>, <em>pseudo</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/spline_conv.html#SplineConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.SplineConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.SplineConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/spline_conv.html#SplineConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.SplineConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.NNConv">
<em class="property">class </em><code class="descname">NNConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>nn</em>, <em>aggr='add'</em>, <em>root_weight=True</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/nn_conv.html#NNConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.NNConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The continuous kernel-based convolutional operator adapted from the
<a class="reference external" href="https://arxiv.org/abs/1704.01212">“Neural Message Passing for Quantum Chemistry”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{\prime}_i = \mathbf{\Theta} \mathbf{x}_i +
\sum_{j \in \mathcal{N}(i)} \mathbf{x}_j \cdot
h_{\mathbf{\Theta}}(\mathbf{e}_{i,j}),\]</div>
<p>where <span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span> denotes a neural network, <em>.i.e.</em>
a MLP.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>nn</strong> (<em>nn.Sequential</em>) – Neural network <span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span>.</li>
<li><strong>aggr</strong> (<em>string</em>) – The aggregation operator to use (one of <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;add&quot;</span></code>,
<code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code>). (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;add&quot;</span></code>)</li>
<li><strong>root_weight</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will
not add the transformed root node features to the output.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.NNConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em>, <em>pseudo</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/nn_conv.html#NNConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.NNConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.NNConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/nn_conv.html#NNConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.NNConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.EdgeConv">
<em class="property">class </em><code class="descname">EdgeConv</code><span class="sig-paren">(</span><em>nn</em>, <em>aggr='add'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/edge_conv.html#EdgeConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.EdgeConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The edge convolutional operator from the <a class="reference external" href="https://arxiv.org/abs/1801.07829">“Dynamic Graph CNN for
Learning on Point Clouds”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{\prime}_i = \sum_{j \in \mathcal{N}(i)}
h_{\mathbf{\Theta}}(\mathbf{x}_i \, \Vert \,
\mathbf{x}_j - \mathbf{x}_i),\]</div>
<p>where <span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span> denotes a neural network, <em>.i.e.</em> a MLP.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nn</strong> (<em>nn.Sequential</em>) – Neural network <span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span>.</li>
<li><strong>aggr</strong> (<em>string</em>) – The aggregation operator to use (one of <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;add&quot;</span></code>,
<code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code>). (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;add&quot;</span></code>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.EdgeConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/edge_conv.html#EdgeConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.EdgeConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.EdgeConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/edge_conv.html#EdgeConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.EdgeConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.conv.XConv">
<em class="property">class </em><code class="descname">XConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>dim</em>, <em>kernel_size</em>, <em>hidden_channels=None</em>, <em>dilation=1</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/x_conv.html#XConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.XConv" title="Permalink to this definition">¶</a></dt>
<dd><p>The convolutional operator on <span class="math notranslate nohighlight">\(\mathcal{X}\)</span>-transformed points
from the <a class="reference external" href="https://arxiv.org/abs/1801.07791">“PointCNN: Convolution On X-Transformed Points”</a> paper</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{\prime}_i = \mathrm{Conv}\left(\mathbf{K},
\gamma_{\mathbf{\Theta}}(\mathbf{P}_i - \mathbf{p}_i) \times
\left( h_\mathbf{\Theta}(\mathbf{P}_i - \mathbf{p}_i) \, \Vert \,
\mathbf{x}_i \right) \right),\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{P}_i\)</span> denote the trainable
filter and neighboring point positions of <span class="math notranslate nohighlight">\(\mathbf{x}_i\)</span>,
respectively.
<span class="math notranslate nohighlight">\(\gamma_{\mathbf{\Theta}}\)</span> and <span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span> describe
neural networks, <em>i.e.</em> MLPs, where <span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span>
individually lifts each point into a higher-dimensional space, and
<span class="math notranslate nohighlight">\(\gamma_{\mathbf{\Theta}}\)</span> computes the <span class="math notranslate nohighlight">\(\mathcal{X}\)</span>-
transformation matrix based on <em>all</em> points in a neighborhood.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each output sample.</li>
<li><strong>kernel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of the convolving kernel, <em>i.e.</em> number of
neighbors including self-loops.</li>
<li><strong>hidden_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Output size of
<span class="math notranslate nohighlight">\(h_{\mathbf{\Theta}}\)</span>, <em>i.e.</em> dimensionality of lifted
points. If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, will be automatically set to
<code class="xref py py-obj docutils literal notranslate"><span class="pre">in_channels</span> <span class="pre">/</span> <span class="pre">4</span></code>. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The factor by which the neighborhood is
extended, from which <code class="xref py py-obj docutils literal notranslate"><span class="pre">kernel_size</span></code> neighbors are then
uniformly sampled. Can be interpreted as the dilation rate of
classical convolutional operators. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">1</span></code>)</li>
<li><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will not learn
an additive bias. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.conv.XConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>pos</em>, <em>batch=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/x_conv.html#XConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.XConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.conv.XConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/conv/x_conv.html#XConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.conv.XConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<span class="target" id="module-torch_geometric.nn.meta"></span><dl class="class">
<dt id="torch_geometric.nn.meta.MetaLayer">
<em class="property">class </em><code class="descname">MetaLayer</code><span class="sig-paren">(</span><em>edge_model=None</em>, <em>node_model=None</em>, <em>global_model=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/meta.html#MetaLayer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.meta.MetaLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>A meta layer for building any kind of graph network, inspired by the
<a class="reference external" href="https://arxiv.org/abs/1806.01261">“Relational Inductive Biases, Deep Learning, and Graph Networks”</a> paper.</p>
<p>A graph network takes a graph as input and returns an updated graph as
output (with same connectivity).
The input graph has node features <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code>, edge features <code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_attr</span></code>
as well as global-level features <code class="xref py py-obj docutils literal notranslate"><span class="pre">u</span></code>.
The output graph has the same structure, but updated features.</p>
<p>Edge features, node features as well as global features are updated by
calling the functions <code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_model</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">node_model</span></code> and
<code class="xref py py-obj docutils literal notranslate"><span class="pre">global_model</span></code>, respectively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>edge_model</strong> (<em>func</em><em>, </em><em>optional</em>) – A callable which updates a graph’s edge
features based on its source and target node features, its current
edge features and its global features. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>node_model</strong> (<em>func</em><em>, </em><em>optional</em>) – A callable which updates a graph’s node
features based on its current node features, its graph
connectivity, its edge features and its global features.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>global_model</strong> (<em>func</em><em>, </em><em>optional</em>) – A callable which updates a graph’s
global features based on its node features, its graph connectivity,
its edge features and its current global features. To allow for
batch-wise graph processing, the callable takes a fifth argument
<code class="xref py py-obj docutils literal notranslate"><span class="pre">batch</span></code>, which determines the assignment of nodes to their
specific graphs. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">torch.nn</span> <span class="kn">import</span> <span class="n">Sequential</span> <span class="k">as</span> <span class="n">Seq</span><span class="p">,</span> <span class="n">Linear</span> <span class="k">as</span> <span class="n">Lin</span><span class="p">,</span> <span class="n">ReLU</span>
<span class="kn">from</span> <span class="nn">torch_scatter</span> <span class="kn">import</span> <span class="n">scatter_mean</span>
<span class="kn">from</span> <span class="nn">torch_geometric.nn</span> <span class="kn">import</span> <span class="n">MetaLayer</span>

<span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Net</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">edge_mlp</span> <span class="o">=</span> <span class="n">Seq</span><span class="p">(</span><span class="n">Lin</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span> <span class="n">ReLU</span><span class="p">(),</span> <span class="n">Lin</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_mlp</span> <span class="o">=</span> <span class="n">Seq</span><span class="p">(</span><span class="n">Lin</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span> <span class="n">ReLU</span><span class="p">(),</span> <span class="n">Lin</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_mlp</span> <span class="o">=</span> <span class="n">Seq</span><span class="p">(</span><span class="n">Lin</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span> <span class="n">ReLU</span><span class="p">(),</span> <span class="n">Lin</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">))</span>

        <span class="k">def</span> <span class="nf">edge_model</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">edge_attr</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
            <span class="c1"># source, target: [E, F_x], where E is the number of edges.</span>
            <span class="c1"># edge_attr: [E, F_e]</span>
            <span class="c1"># u: [B, F_u], where B is the number of graphs.</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">edge_attr</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_mlp</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">node_model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">edge_index</span><span class="p">,</span> <span class="n">edge_attr</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
            <span class="c1"># x: [N, F_x], where N is the number of nodes.</span>
            <span class="c1"># edge_index: [2, E] with max entry N - 1.</span>
            <span class="c1"># edge_attr: [E, F_e]</span>
            <span class="c1"># u: [B, F_u]</span>
            <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">edge_index</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">edge_attr</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_mlp</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">scatter_mean</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim_size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

        <span class="k">def</span> <span class="nf">global_model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">edge_index</span><span class="p">,</span> <span class="n">edge_attr</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
            <span class="c1"># x: [N, F_x], where N is the number of nodes.</span>
            <span class="c1"># edge_index: [2, E] with max entry N - 1.</span>
            <span class="c1"># edge_attr: [E, F_e]</span>
            <span class="c1"># u: [B, F_u]</span>
            <span class="c1"># batch: [N] with max entry B - 1.</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">u</span><span class="p">,</span> <span class="n">scatter_mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_mlp</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">op</span> <span class="o">=</span> <span class="n">MetaLayer</span><span class="p">(</span><span class="n">edge_model</span><span class="p">,</span> <span class="n">node_model</span><span class="p">,</span> <span class="n">global_model</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">edge_index</span><span class="p">,</span> <span class="n">edge_attr</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">edge_index</span><span class="p">,</span> <span class="n">edge_attr</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">batch</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="torch_geometric.nn.meta.MetaLayer.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em>, <em>edge_attr=None</em>, <em>u=None</em>, <em>batch=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/meta.html#MetaLayer.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.meta.MetaLayer.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.meta.MetaLayer.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/meta.html#MetaLayer.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.meta.MetaLayer.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-torch_geometric.nn.dense.sage_conv">
<span id="dense-convolutional-layers"></span><h2><a class="toc-backref" href="#id2">Dense Convolutional Layers</a><a class="headerlink" href="#module-torch_geometric.nn.dense.sage_conv" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch_geometric.nn.dense.sage_conv.DenseSAGEConv">
<em class="property">class </em><code class="descname">DenseSAGEConv</code><span class="sig-paren">(</span><em>in_channels</em>, <em>out_channels</em>, <em>normalize=True</em>, <em>bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/dense/sage_conv.html#DenseSAGEConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.dense.sage_conv.DenseSAGEConv" title="Permalink to this definition">¶</a></dt>
<dd><p>See <code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.nn.conv.sage_conv.SAGEConv</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.dense.sage_conv.DenseSAGEConv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>adj</em>, <em>mask=None</em>, <em>add_loop=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/dense/sage_conv.html#DenseSAGEConv.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.dense.sage_conv.DenseSAGEConv.forward" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<em>Tensor</em>) – Node feature tensor <span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{B
\times N \times F}\)</span>, with batch-size <span class="math notranslate nohighlight">\(B\)</span>, (maximum)
number of nodes <span class="math notranslate nohighlight">\(N\)</span> for each graph, and feature
dimension <span class="math notranslate nohighlight">\(F\)</span>.</li>
<li><strong>adj</strong> (<em>Tensor</em>) – Adjacency tensor <span class="math notranslate nohighlight">\(\mathbf{A} \in \mathbb{R}^{B
\times N \times N}\)</span>.</li>
<li><strong>mask</strong> (<em>ByteTensor</em><em>, </em><em>optional</em>) – Mask matrix
<span class="math notranslate nohighlight">\(\mathbf{M} \in {\{ 0, 1 \}}^{B \times N}\)</span> indicating
the valid nodes for each graph. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
<li><strong>add_loop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the layer will
not automatically add self-loops to the adjacency matrices.
(default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.dense.sage_conv.DenseSAGEConv.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/dense/sage_conv.html#DenseSAGEConv.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.dense.sage_conv.DenseSAGEConv.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-torch_geometric.nn.glob">
<span id="global-pooling-layers"></span><h2><a class="toc-backref" href="#id3">Global Pooling Layers</a><a class="headerlink" href="#module-torch_geometric.nn.glob" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="torch_geometric.nn.glob.global_add_pool">
<code class="descname">global_add_pool</code><span class="sig-paren">(</span><em>x</em>, <em>batch</em>, <em>size=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/glob/glob.html#global_add_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.glob.global_add_pool" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns batch-wise graph-level-outputs by adding node features
across the node node dimension, so that for a single graph
<span class="math notranslate nohighlight">\(\mathcal{G}_i\)</span> its output is computed by</p>
<div class="math notranslate nohighlight">
\[\mathbf{r}_i = \sum_{n=1}^{N_i} \mathbf{x}_n\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>Tensor</em>) – Node feature matrix
<span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{(N_1 + \ldots + N_B) \times F}\)</span>.</li>
<li><strong>batch</strong> (<em>LongTensor</em>) – Batch vector <span class="math notranslate nohighlight">\(\mathbf{b} \in {\{ 0, \ldots,
B-1\}}^N\)</span>, which assigns each node to a specific graph.</li>
<li><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Batch-size <span class="math notranslate nohighlight">\(B\)</span>.
Automatically calculated if not given. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.glob.global_mean_pool">
<code class="descname">global_mean_pool</code><span class="sig-paren">(</span><em>x</em>, <em>batch</em>, <em>size=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/glob/glob.html#global_mean_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.glob.global_mean_pool" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns batch-wise graph-level-outputs by averaging node features
across the node node dimension, so that for a single graph
<span class="math notranslate nohighlight">\(\mathcal{G}_i\)</span> its output is computed by</p>
<div class="math notranslate nohighlight">
\[\mathbf{r}_i = \frac{1}{N_i} \sum_{n=1}^{N_i} \mathbf{x}_n\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>Tensor</em>) – Node feature matrix
<span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{(N_1 + \ldots + N_B) \times F}\)</span>.</li>
<li><strong>batch</strong> (<em>LongTensor</em>) – Batch vector <span class="math notranslate nohighlight">\(\mathbf{b} \in {\{ 0, \ldots,
B-1\}}^N\)</span>, which assigns each node to a specific graph.</li>
<li><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Batch-size <span class="math notranslate nohighlight">\(B\)</span>.
Automatically calculated if not given. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.glob.global_max_pool">
<code class="descname">global_max_pool</code><span class="sig-paren">(</span><em>x</em>, <em>batch</em>, <em>size=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/glob/glob.html#global_max_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.glob.global_max_pool" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns batch-wise graph-level-outputs by taking the channel-wise
maximum node features across the node dimension, so that for a single graph
<span class="math notranslate nohighlight">\(\mathcal{G}_i\)</span> its output is computed by</p>
<div class="math notranslate nohighlight">
\[\mathbf{r}_i = \mathrm{max}_{n=1}^{N_i} \, \mathbf{x}_n\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>Tensor</em>) – Node feature matrix
<span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{(N_1 + \ldots + N_B) \times F}\)</span>.</li>
<li><strong>batch</strong> (<em>LongTensor</em>) – Batch vector <span class="math notranslate nohighlight">\(\mathbf{b} \in {\{ 0, \ldots,
B-1\}}^N\)</span>, which assigns each node to a specific graph.</li>
<li><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Batch-size <span class="math notranslate nohighlight">\(B\)</span>.
Automatically calculated if not given. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.glob.global_sort_pool">
<code class="descname">global_sort_pool</code><span class="sig-paren">(</span><em>x</em>, <em>batch</em>, <em>k</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/glob/sort.html#global_sort_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.glob.global_sort_pool" title="Permalink to this definition">¶</a></dt>
<dd><p>The global pooling operator from the <a class="reference external" href="https://www.cse.wustl.edu/~muhan/papers/AAAI_2018_DGCNN.pdf">“An End-to-End Deep Learning
Architecture for Graph Classification”</a> paper,
where node features are first sorted individually and then  sorted in
descending order based on their last features. The first <span class="math notranslate nohighlight">\(k\)</span> nodes
form the output of the layer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>Tensor</em>) – Node feature matrix
<span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{N \times F}\)</span>.</li>
<li><strong>batch</strong> (<em>LongTensor</em>) – Batch vector <span class="math notranslate nohighlight">\(\mathbf{b} \in {\{ 0, \ldots,
B-1\}}^N\)</span>, which assigns each node to a specific graph.</li>
<li><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The number of nodes to hold for each graph.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.glob.Set2Set">
<em class="property">class </em><code class="descname">Set2Set</code><span class="sig-paren">(</span><em>in_channels</em>, <em>processing_steps</em>, <em>num_layers=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/glob/set2set.html#Set2Set"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.glob.Set2Set" title="Permalink to this definition">¶</a></dt>
<dd><p>The global pooling operator based on iterative content-based attention
from the <a class="reference external" href="https://arxiv.org/abs/1511.06391">“Order Matters: Sequence to sequence for sets”</a> paper</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathbf{q}_t &amp;= \mathrm{LSTM}(\mathbf{q}^{*}_{t-1})\\\alpha_{i,t} &amp;= \mathrm{softmax}(\mathbf{x}_i \cdot \mathbf{q}_t)\\\mathbf{r}_t &amp;= \sum_{i=1}^N \alpha_{i,t} \mathbf{x}_i\\\mathbf{q}^{*}_t &amp;= \mathbf{q}_t \, \Vert \, \mathbf{r}_t,\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{q}^{*}_T\)</span> defines the output of the layer with twice
the dimensionality as the input.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>processing_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of iterations <span class="math notranslate nohighlight">\(T\)</span>.</li>
<li><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Number of recurrent layers, <em>.e.g</em>, setting
<code class="xref py py-obj docutils literal notranslate"><span class="pre">num_layers=2</span></code> would mean stacking two LSTMs together to form
a stacked LSTM, with the second LSTM taking in outputs of the first
LSTM and computing the final results. (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">1</span></code>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.glob.Set2Set.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>batch</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/glob/set2set.html#Set2Set.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.glob.Set2Set.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.glob.Set2Set.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/glob/set2set.html#Set2Set.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.glob.Set2Set.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-torch_geometric.nn.pool">
<span id="sparse-hierarchical-pooling-layers"></span><h2><a class="toc-backref" href="#id4">Sparse Hierarchical Pooling Layers</a><a class="headerlink" href="#module-torch_geometric.nn.pool" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="torch_geometric.nn.pool.max_pool">
<code class="descname">max_pool</code><span class="sig-paren">(</span><em>cluster</em>, <em>data</em>, <em>transform=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/pool/max_pool.html#max_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.max_pool" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.pool.max_pool_x">
<code class="descname">max_pool_x</code><span class="sig-paren">(</span><em>cluster</em>, <em>x</em>, <em>batch</em>, <em>size=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/pool/max_pool.html#max_pool_x"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.max_pool_x" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.pool.avg_pool">
<code class="descname">avg_pool</code><span class="sig-paren">(</span><em>cluster</em>, <em>data</em>, <em>transform=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/pool/avg_pool.html#avg_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.avg_pool" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.pool.avg_pool_x">
<code class="descname">avg_pool_x</code><span class="sig-paren">(</span><em>cluster</em>, <em>x</em>, <em>batch=None</em>, <em>size=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/pool/avg_pool.html#avg_pool_x"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.avg_pool_x" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.pool.graclus">
<code class="descname">graclus</code><span class="sig-paren">(</span><em>edge_index</em>, <em>weight=None</em>, <em>num_nodes=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/pool/graclus.html#graclus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.graclus" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="torch_geometric.nn.pool.voxel_grid">
<code class="descname">voxel_grid</code><span class="sig-paren">(</span><em>pos</em>, <em>batch</em>, <em>size</em>, <em>start=None</em>, <em>end=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/pool/voxel_grid.html#voxel_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.voxel_grid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="torch_geometric.nn.pool.TopKPooling">
<em class="property">class </em><code class="descname">TopKPooling</code><span class="sig-paren">(</span><em>in_channels</em>, <em>ratio=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/pool/topk_pool.html#TopKPooling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.TopKPooling" title="Permalink to this definition">¶</a></dt>
<dd><p><span class="math notranslate nohighlight">\(\mathrm{top}_k\)</span> pooling operator from the <a class="reference external" href="https://openreview.net/forum?id=HJePRoAct7">“Graph U-Net”</a> and <a class="reference external" href="https://arxiv.org/abs/1811.01287">“Towards Sparse
Hierarchical Graph Classifiers”</a> papers</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathbf{y} &amp;= \frac{\mathbf{X}\mathbf{p}}{\| \mathbf{p} \|}\\\mathbf{i} &amp;= \mathrm{top}_k(\mathbf{y})\\\mathbf{X}^{\prime} &amp;= (\mathbf{X} \odot
\mathrm{tanh}(\mathbf{y}))_{\mathbf{i}}\\\mathbf{A}^{\prime} &amp;= \mathbf{A}_{\mathbf{i},\mathbf{i}},\end{aligned}\end{align} \]</div>
<p>where nodes are dropped based on a learnable projection score
<span class="math notranslate nohighlight">\(\mathbf{p}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of each input sample.</li>
<li><strong>ratio</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Graph pooling ratio, which is used to compute
<span class="math notranslate nohighlight">\(k = \lceil \mathrm{ratio} \cdot N \rceil\)</span>.
(default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">0.5</span></code>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torch_geometric.nn.pool.TopKPooling.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>edge_index</em>, <em>edge_attr=None</em>, <em>batch=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/pool/topk_pool.html#TopKPooling.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.TopKPooling.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="torch_geometric.nn.pool.TopKPooling.reset_parameters">
<code class="descname">reset_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/pool/topk_pool.html#TopKPooling.reset_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.pool.TopKPooling.reset_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-torch_geometric.nn.dense.diff_pool">
<span id="dense-hierarchical-pooling-layers"></span><h2><a class="toc-backref" href="#id5">Dense Hierarchical Pooling Layers</a><a class="headerlink" href="#module-torch_geometric.nn.dense.diff_pool" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="torch_geometric.nn.dense.diff_pool.dense_diff_pool">
<code class="descname">dense_diff_pool</code><span class="sig-paren">(</span><em>x</em>, <em>adj</em>, <em>s</em>, <em>mask=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_geometric/nn/dense/diff_pool.html#dense_diff_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch_geometric.nn.dense.diff_pool.dense_diff_pool" title="Permalink to this definition">¶</a></dt>
<dd><p>Differentiable pooling operator from the <a class="reference external" href="https://arxiv.org/abs/1806.08804">“Hierarchical Graph
Representation Learning with Differentiable Pooling”</a> paper</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathbf{X}^{\prime} &amp;= {\mathrm{softmax}(\mathbf{S})}^{\top} \cdot
\mathbf{X}\\\mathbf{A}^{\prime} &amp;= {\mathrm{softmax}(\mathbf{S})}^{\top} \cdot
\mathbf{A} \cdot \mathrm{softmax}(\mathbf{S})\end{aligned}\end{align} \]</div>
<p>based on dense learned assignments <span class="math notranslate nohighlight">\(\mathbf{S} \in \mathbb{R}^{B
\times N \times C}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>Tensor</em>) – Node feature tensor <span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{B
\times N \times F}\)</span> with batch-size <span class="math notranslate nohighlight">\(B\)</span>, (maximum)
number of nodes <span class="math notranslate nohighlight">\(N\)</span> for each graph, and feature dimension
<span class="math notranslate nohighlight">\(F\)</span>.</li>
<li><strong>adj</strong> (<em>Tensor</em>) – Adjacency tensor <span class="math notranslate nohighlight">\(\mathbf{A} \in \mathbb{R}^{B
\times N \times N}\)</span>.</li>
<li><strong>s</strong> (<em>Tensor</em>) – Assignment tensor <span class="math notranslate nohighlight">\(\mathbf{S} \in \mathbb{R}^{B
\times N \times C}\)</span> with number of clusters <span class="math notranslate nohighlight">\(C\)</span>. The softmax
does not have to be applied beforehand, since it is executed
within this method.</li>
<li><strong>mask</strong> (<em>ByteTensor</em><em>, </em><em>optional</em>) – Mask matrix
<span class="math notranslate nohighlight">\(\mathbf{M} \in {\{ 0, 1 \}}^{B \times N}\)</span> indicating
the valid nodes for each graph. (default: <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="data.html" class="btn btn-neutral float-right" title="torch_geometric.data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../notes/create_dataset.html" class="btn btn-neutral" title="Create your own dataset" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Matthias Fey.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'master',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>